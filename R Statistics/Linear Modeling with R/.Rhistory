# Chunk 1: Assignment 6
## Set the working directory
setwd("/Users/kimberlyadams/Documents/GitHub/Portfolio/R Statistics/Linear Modeling with R")
## Load the ggplot2 library
library(ggplot2)
{r Load the data, include = FALSE}
# Chunk 1: Load the data
## Set the working directory
setwd("/Users/kimberlyadams/Documents/GitHub/Portfolio/R Statistics/Linear Modeling with R")
## Load the ggplot2 library
library(ggplot2)
## Get current working directory
getwd()
## Housing data set cleanup
## Prevent scientific notation
options(scipen = 999)
library(readxl)
## Load the downloaded data from file
housing_data = read_excel('/Users/kimberlyadams/Documents/GitHub/Portfolio/R Statistics/Linear Modeling with R/week-7-housing.xlsx', sheet = 'Sheet2', .name_repair = 'universal')
# Chunk 2: Add models
PriceBySqFtLot.lm = lm(Sale.Price ~ sq_ft_lot, data = housing_data)
PriceBuildLotSize.lm = lm(Sale.Price ~ sq_ft_lot + year_built, data = housing_data)
# Chunk 3: Summary Price by Square Foot Lot
summary(PriceBySqFtLot.lm)
summary(PriceBuildLotSize.lm)
# Chunk 4: Standardized beta estimates
QuantPsyc::lm.beta(PriceBuildLotSize.lm)
# Chunk 5: Confidence intervals
cor.test(housing_data$Sale.Price, housing_data$year_built)
cor.test(housing_data$Sale.Price, housing_data$sq_ft_lot)
# Chunk 6: ANOVA
anova(PriceBySqFtLot.lm, PriceBuildLotSize.lm)
# Chunk 7: Casewise diagnostics
housing_data$Residuals <- resid(PriceBuildLotSize.lm)
housing_data$StandResiduals <- rstandard(PriceBuildLotSize.lm)
housing_data$StudentResiduals <- rstudent(PriceBuildLotSize.lm)
housing_data$Cooks <- cooks.distance(PriceBuildLotSize.lm)
housing_data$DFBeta <- dfbeta(PriceBuildLotSize.lm)
housing_data$DFFit <- dffits(PriceBuildLotSize.lm)
housing_data$leverage <- hatvalues(PriceBuildLotSize.lm)
housing_data$covarRatio <- covratio(PriceBuildLotSize.lm)
# Chunk 8: Large Residuals
housing_data$LargeResidual <- housing_data$StandResiduals > 2 | housing_data$StandResiduals < -2
# Chunk 9: Residual Sum
sum(housing_data$LargeResidual)
# Chunk 10: Which are residuals
housing_data[housing_data$LargeResidual, c("Sale.Price","sq_ft_lot", "StandResiduals")]
# Chunk 11: Further investigations
housing_data[housing_data$LargeResidual, c("Cooks","leverage", "covarRatio")]
# Chunk 12: Assumption of Independence
car::durbinWatsonTest(PriceBuildLotSize.lm)
# Chunk 13: assumption of no multicollinearity
library(car)
vif(PriceBuildLotSize.lm)
1 / vif(PriceBuildLotSize.lm)
mean(vif(PriceBuildLotSize.lm))
# Chunk 14: Histograms
hist(housing_data$Sale.Price, main = "Sale Price")
boxplot(housing_data$Sale.Price, main = "Sale Price")
hist(housing_data$year_built, main = "Year Built")
boxplot(housing_data$year_built, main = "Year Built")
hist(housing_data$sq_ft_lot, main = "Lot Size")
boxplot(housing_data$sq_ft_lot, main = "Lot Size")
# Chunk 15: Graphs
plot(PriceBuildLotSize.lm)
